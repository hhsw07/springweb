<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >	
<mapper namespace="springweb.a03_mvc.a03_repository.BoardDao">
 	<resultMap type="board" id="boardResult"/>
 	<select id="list" resultMap="boardResult" parameterType="board" >
		select * 
		from reboard
		where 1=1
		<if test="title!=null and title!=''">
		and title like '%'||#{title}||'%'
		</if>
		<if test="writer!=null and writer!=''">
		and writer like '%'||#{writer}||'%'
		</if>
		order by no desc
 	</select>
 	<insert id="insert" parameterType="board">
	 	INSERT INTO REBOARD values(reboard_seq.nextval,#{refno}, 
			#{title},#{content},#{writer},0,sysdate,sysdate,'')
 	</insert>
 	<!-- 
 //  insertRepo(String fname);
 //  insert into boardfile values(reboard_seq.currval, #{fname}, sysdate, sysdate, '')
 	 -->
 	<insert id="insertRepo" parameterType="String"> 
 		insert into boardfile values(reboard_seq.currval, 
 			#{fname}, sysdate, sysdate, '')
	</insert>
 	<select id="getBoard" 
 		resultType="board" parameterType="int">
 		SELECT *
 		FROM reboard
 		WHERE no = #{no}
 	</select>
 	<!-- 
 	ArrayList<String> fname(int no);
 	 -->
 	<resultMap type="String" id="strMap"/> 
 	<select id="fnames" resultMap="strMap" parameterType="int">
 		SELECT fname 
 		FROM boardfile		
 		WHERE no=#{no}
 	</select> 	
 	<update id="uptReadCnt" parameterType="int">
 		UPDATE reboard
 		   SET readcnt = readcnt+1
 		 WHERE no = #{no}
 	</update>
 	
 	<update id="update" parameterType="board">
 		UPDATE reboard
 		   SET refno = #{refno},
 		   	   writer = #{writer},
 		       title = #{title},
 		       content = #{content},
 		       uptdte = sysdate
 		 WHERE no = #{no}
 	</update>
 	<delete id="delete" parameterType="int">
 		DELETE reboard
		 WHERE NO = #{no}
 	</delete>
 	
 	
</mapper>	


